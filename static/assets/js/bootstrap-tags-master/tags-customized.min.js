const DEFAULTS={allowNew:!1,showAllSuggestions:!1,badgeStyle:"tag",allowClear:!1,clearEnd:!1,selected:[],regex:"",separator:[],max:0,clearLabel:"Clear",searchLabel:"Type a value",keepOpen:!1,allowSame:!1,baseClass:"",placeholder:"",addOnBlur:!1,showDisabled:!1,hideNativeValidation:!1,suggestionsThreshold:1,maximumItems:0,autoselectFirst:!0,updateOnSelect:!1,highlightTyped:!1,fullWidth:!1,fixed:!1,activeClasses:["active-tag"],labelField:"label",valueField:"value",queryParam:"query",server:"",serverMethod:"GET",serverParams:{},fetchOptions:{},liveServer:!1,noCache:!0,debounceTime:300,notFoundMessage:"",onRenderItem:(e,t,s)=>t,onSelectItem:(e,t)=>{},onClearItem:(e,t)=>{},onCanAdd:(e,t,s)=>{},onServerResponse:e=>e.json()},CLASS_PREFIX="tags-",LOADING_CLASS="is-loading",ACTIVE_CLASS="is-active",INVALID_CLASS="is-invalid",SHOW_CLASS="show",VALUE_ATTRIBUTE="data-value",NEXT="next",PREV="prev",FOCUS_CLASS="form-control-focus",PLACEHOLDER_CLASS="form-placeholder-shown",DISABLED_CLASS="form-control-disabled",INSTANCE_MAP=new WeakMap;let counter=0;function debounce(t,s=300){let i;return(...e)=>{clearTimeout(i),i=setTimeout(()=>{t.apply(this,e)},s)}}function calcTextWidth(e,t=null){const s=document.createElement("span");document.body.appendChild(s),s.style.fontSize=t||"inherit",s.style.height="auto",s.style.width="auto",s.style.position="absolute",s.style.whiteSpace="no-wrap",s.innerHTML=e;e=Math.ceil(s.clientWidth)+8;return document.body.removeChild(s),e}function removeDiacritics(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function hideItem(e){e.style.display="none",e.ariaHidden="true"}function showItem(e){e.style.display="list-item",e.ariaHidden="false"}class BootstrapInputsTags{constructor(e,t={}){e instanceof HTMLElement?(INSTANCE_MAP.set(e,this),counter++,this._selectElement=e,this._configure(t),this._keyboardNavigation=!1,this._searchFunc=debounce(()=>{this._loadFromServer(!0)},this._config.debounceTime),this._fireEvents=!0,this._configureParent(),this._holderElement=document.createElement("div"),this._containerElement=document.createElement("div"),this._holderElement.appendChild(this._containerElement),this._selectElement.parentElement.insertBefore(this._holderElement,this._selectElement),this._configureHolderElement(),this._configureContainerElement(),this._configureSelectElement(),this._configureSearchInput(),this._configureDropElement(),this.resetState(),this._config.fixed&&(document.addEventListener("scroll",this,!0),window.addEventListener("resize",this)),this._searchInput.addEventListener("focus",this),this._searchInput.addEventListener("blur",this),this._searchInput.addEventListener("input",this),this._searchInput.addEventListener("keydown",this),this._dropElement.addEventListener("mousemove",this),this.loadData()):console.error("Invalid element",e)}static init(e="select[multiple]",t={}){var s=document.querySelectorAll(e);for(let e=0;e<s.length;e++)BootstrapInputsTags.getInstance(s[e])||new BootstrapInputsTags(s[e],t)}static getInstance(e){if(INSTANCE_MAP.has(e))return INSTANCE_MAP.get(e)}dispose(){this._searchInput.removeEventListener("focus",this),this._searchInput.removeEventListener("blur",this),this._searchInput.removeEventListener("input",this),this._searchInput.removeEventListener("keydown",this),this._dropElement.removeEventListener("mousemove",this),this._config.fixed&&(document.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this)),this._selectElement.style.display="block",this._holderElement.parentElement.removeChild(this._holderElement),this.parentForm&&this.parentForm.removeEventListener("reset",this),INSTANCE_MAP.delete(this._selectElement)}handleEvent(e){this[`on${e.type}`](e)}_configure(e={}){this._config=Object.assign({},DEFAULTS);var t,s,i,n,l={...e,...this._selectElement.dataset};for([t,s]of Object.entries(DEFAULTS))if(void 0!==l[t]){const o=l[t];switch(typeof s){case"number":this._config[t]=parseInt(o);break;case"boolean":this._config[t]=(n=o,["true","false","1","0",!0,!1].includes(n)&&!!JSON.parse(n));break;case"string":this._config[t]=o.toString();break;case"object":Array.isArray(s)?(i=o.includes("|")?"|":",",this._config[t]="string"==typeof o?o.split(i):o):this._config[t]="string"==typeof o?JSON.parse(o):o;break;case"function":this._config[t]="string"==typeof o?window[o]:o;break;default:this._config[t]=o}}this._config.placeholder||(this._config.placeholder=this._getPlaceholder())}_configureParent(){for(this.overflowParent=null,this.parentForm=this._selectElement.parentElement;this.parentForm&&("hidden"===this.parentForm.style.overflow&&(this.overflowParent=this.parentForm),this.parentForm=this.parentForm.parentElement,!this.parentForm||"FORM"!=this.parentForm.nodeName););this.parentForm&&this.parentForm.addEventListener("reset",this)}_getPlaceholder(){if(this._selectElement.hasAttribute("placeholder"))return this._selectElement.getAttribute("placeholder");if(this._selectElement.dataset.placeholder)return this._selectElement.dataset.placeholder;let e=this._selectElement.querySelector("option");return e?(e.hasAttribute("selected")&&e.removeAttribute("selected"),e.value?"":e.textContent):""}_configureSelectElement(){this._config.hideNativeValidation?(this._selectElement.style.position="absolute",this._selectElement.style.left="-9999px"):this._selectElement.style.cssText="height:1px;width:1px;opacity:0;padding:0;margin:0;border:0;float:left;flex-basis:100%;",this._selectElement.tabIndex=-1,this._selectElement.addEventListener("focus",e=>{this.onclick()}),this._selectElement.addEventListener("invalid",e=>{this._holderElement.classList.add(INVALID_CLASS)})}_configureDropElement(){this._dropElement=document.createElement("ul"),this._dropElement.classList.add("dropdown-menu",CLASS_PREFIX+"menu","p-0"),this._dropElement.setAttribute("id",CLASS_PREFIX+"menu-"+counter),this._dropElement.setAttribute("role","menu"),this._dropElement.style.maxHeight="280px",this._config.fullWidth||(this._dropElement.style.maxWidth="360px"),this._config.fixed&&(this._dropElement.style.position="fixed"),this._dropElement.style.overflowY="auto",this._dropElement.style.overscrollBehavior="contain",this._dropElement.style.textAlign="unset",this._dropElement.addEventListener("mouseenter",e=>{this._keyboardNavigation=!1}),this._holderElement.appendChild(this._dropElement),this._searchInput.setAttribute("aria-controls",this._dropElement.getAttribute("id"))}_configureHolderElement(){this._holderElement.classList.add("form-control","dropdown"),this._selectElement.classList.contains("form-select-lg")&&this._holderElement.classList.add("form-control-lg"),this._selectElement.classList.contains("form-select-sm")&&this._holderElement.classList.add("form-control-sm"),this.overflowParent&&(this._holderElement.style.position="inherit"),4===this._getBootstrapVersion()&&(this._holderElement.style.height="auto")}_configureContainerElement(){this._containerElement.addEventListener("click",e=>{this.isDisabled()||"hidden"!=this._searchInput.style.visibility&&this._searchInput.focus()}),this._containerElement.style.display="flex",this._containerElement.style.alignItems="center",this._containerElement.style.flexWrap="wrap";var s=this._selectElement.selectedOptions||[];for(let t=0;t<s.length;t++){let e=s[t];e.value&&(e.setAttribute("selected","selected"),e.dataset.init="true",e.hasAttribute("disabled")&&(e.dataset.disabled="true"),this._createBadge(e.textContent,e.value,e.dataset))}}_configureSearchInput(){this._searchInput=document.createElement("input"),this._searchInput.type="text",this._searchInput.autocomplete="off",this._searchInput.spellcheck=!1,this._searchInput.ariaAutoComplete="list",this._searchInput.ariaExpanded="false",this._searchInput.ariaHasPopup="menu",this._searchInput.setAttribute("role","combobox"),this._searchInput.ariaLabel=this._config.searchLabel,this._searchInput.style.cssText="backgroundColor:transparent;color:currentColor;border:0;padding:4px 0 4px 4px;outline:0;maxWidth:100%",this.resetSearchInput(!0),this._containerElement.appendChild(this._searchInput)}onfocus(e){this._holderElement.classList.add(FOCUS_CLASS),this.showOrSearch()}onblur(e){this._abortController&&this._abortController.abort(),this._holderElement.classList.remove(FOCUS_CLASS),this.hideSuggestions(),this._config.keepOpen&&this.resetSearchInput();var t=this.getSelection(),t={selection:t?t.dataset.value:null,input:this._searchInput.value};this._config.addOnBlur&&this._config.allowNew&&(this._searchInput.dispatchEvent(new KeyboardEvent("keydown",{code:"Enter",key:"Enter",charCode:13,keyCode:13,view:window,bubbles:!0})),this.resetSearchInput()),this._fireEvents&&this._selectElement.dispatchEvent(new CustomEvent("tags.blur",{bubbles:!0,detail:t}))}oninput(e){const t=this._searchInput.value;if(t){var s=t.slice(-1);if(this._config.separator.length&&this._config.separator.includes(s)){this._searchInput.value=this._searchInput.value.slice(0,-1);let e=this._searchInput.value,t=e;if(!this._config.allowNew){const i=this.getSelection();if(!i)return;e=i.getAttribute(VALUE_ATTRIBUTE),t=i.dataset.label}return void this._add(t,e)}}setTimeout(()=>{this._adjustWidth()}),this.showOrSearch()}onkeydown(t){let s=t.keyCode||t.key;const i=t.target;switch(229==t.keyCode&&(s=i.value.charAt(i.selectionStart-1).charCodeAt(0)),s){case 13:case"Enter":t.preventDefault();let e=this.getSelection();var n;e?e.click():this._config.allowNew&&this._searchInput.value&&(n=this._searchInput.value,this._add(n,n,{new:1}));break;case 38:case"ArrowUp":t.preventDefault(),this._keyboardNavigation=!0,this._moveSelection(PREV);break;case 40:case"ArrowDown":t.preventDefault(),this._keyboardNavigation=!0,this.isDropdownVisible()?this._moveSelection(NEXT):this.showOrSearch(!1);break;case 8:case"Backspace":0==this._searchInput.value.length&&(this.removeLastItem(),this._adjustWidth(),this.showOrSearch());break;case 27:case"Escape":this._searchInput.focus(),this.hideSuggestions()}}onmousemove(e){this._keyboardNavigation=!1}onscroll(e){this._positionMenu()}onresize(e){this._positionMenu()}onclick(e){this._searchInput.focus()}onreset(e){this.reset()}loadData(){this._config.server?this._config.liveServer||this._loadFromServer():this.resetSuggestions()}resetState(){this.isDisabled()?(this._holderElement.setAttribute("readonly",""),this._searchInput.setAttribute("disabled",""),this._holderElement.classList.add(DISABLED_CLASS)):(this._holderElement.hasAttribute("readonly")&&this._holderElement.removeAttribute("readonly"),this._searchInput.hasAttribute("disabled")&&this._searchInput.removeAttribute("disabled"),this._holderElement.classList.remove(DISABLED_CLASS))}resetSuggestions(){var e=Array.from(this._selectElement.children).filter(e=>e instanceof HTMLOptGroupElement||!e.disabled||this._config.showDisabled).map(e=>e instanceof HTMLOptGroupElement?{group:e.getAttribute("label"),items:e.children}:{value:e.getAttribute("value"),label:e.textContent,disabled:e.disabled,data:Object.assign({},e.dataset)});this._buildSuggestions(e)}_loadFromServer(t=!1){this._abortController&&this._abortController.abort(),this._abortController=new AbortController;const e=Object.assign({},this._config.serverParams);var s;e[this._config.queryParam]=this._searchInput.value,this._config.noCache&&(e.t=Date.now()),!e.related||(s=document.getElementById(e.related))&&(e.related=s.value);const i=new URLSearchParams(e);let n=this._config.server,l=Object.assign(this._config.fetchOptions,{method:this._config.serverMethod||"GET",signal:this._abortController.signal});"POST"===l.method?l.body=i:n+="?"+i.toString(),this._holderElement.classList.add(LOADING_CLASS),fetch(n,l).then(e=>this._config.onServerResponse(e)).then(e=>{e=e.data||e;this._buildSuggestions(e),this._abortController=null,t&&this._showSuggestions()}).catch(e=>{"AbortError"!==e.name&&console.error(e)}).finally(e=>{this._holderElement.classList.remove(LOADING_CLASS)})}_add(e,t=null,s={}){if(!this.canAdd(e,s))return null;s=this.addItem(e,t,s);return this._config.keepOpen?this._showSuggestions():this.resetSearchInput(),s}_isItemEnabled(e){if("none"===e.style.display)return!1;const t=e.firstElementChild;return"A"===t.tagName&&!t.classList.contains("disabled")}_moveSelection(e=NEXT,t=null){const s=this.getSelection();if(s){var i=e===NEXT?"nextSibling":"previousSibling";for(t=s.parentNode;(t=t[i])&&!this._isItemEnabled(t););t?s.classList.remove(...this._activeClasses()):s&&(t=s.parentElement)}else{if(e===PREV)return t;if(!t)for(t=this._dropElement.firstChild;t&&!this._isItemEnabled(t);)t=t.nextSibling}if(t){var n=t.offsetHeight,l=t.offsetTop;const h=t.parentNode;var o=h.offsetHeight,r=h.scrollHeight,a=h.offsetTop;0===n&&setTimeout(()=>{h.scrollTop=0}),e===PREV?h.scrollTop=10<l-a?l-a:0:0<l+n-(o+h.scrollTop)&&0<n&&(h.scrollTop=l+n-o+1,h.scrollTop+o>=r-10&&(h.scrollTop=l-a));const c=t.querySelector("a");c.classList.add(...this._activeClasses()),this._searchInput.setAttribute("aria-activedescendant",c.getAttribute("id")),this._config.updateOnSelect&&(this._searchInput.value=c.dataset.label,this._adjustWidth())}else this._searchInput.setAttribute("aria-activedescendant","");return t}_adjustWidth(){this._holderElement.classList.remove(PLACEHOLDER_CLASS),this._searchInput.value?this._searchInput.size=this._searchInput.value.length:this.getSelectedValues().length?(this._searchInput.placeholder="",this._searchInput.size=1):(this._searchInput.size=0<this._config.placeholder.length?this._config.placeholder.length:1,this._searchInput.placeholder=this._config.placeholder,this._holderElement.classList.add(PLACEHOLDER_CLASS));var e=calcTextWidth(this._searchInput.value||this._searchInput.placeholder,window.getComputedStyle(this._holderElement).fontSize);this._searchInput.style.width=e+"px"}_buildSuggestions(t){for(;this._dropElement.lastChild;)this._dropElement.removeChild(this._dropElement.lastChild);let s=0,i=1;for(let e=0;e<t.length;e++){var n=t[e];if(n.group){const l=document.createElement("li");l.setAttribute("role","presentation"),l.dataset.id=""+i;const o=document.createElement("span");if(l.append(o),o.classList.add("dropdown-header","text-truncate"),o.innerHTML=n.group,this._dropElement.appendChild(l),n.items)for(let e=0;e<n.items.length;e++){const r=n.items[e];r.group_id=i,this._buildSuggestionsItem(n.items[e],s),s++}i++}this._buildSuggestionsItem(n,s),s++}if(this._config.notFoundMessage){const e=document.createElement("li");e.setAttribute("role","presentation"),e.classList.add(CLASS_PREFIX+"not-found"),e.innerHTML=`<span class="dropdown-item">${this._config.notFoundMessage}</span>`,this._dropElement.appendChild(e)}}_buildSuggestionsItem(t,e){if(t[this._config.valueField]){const i=t[this._config.valueField],n=t[this._config.labelField];if(this._config.server&&!this._config.liveServer&&(t.selected||this._config.selected.includes(i))){const a=this._add(n,i,t.data);a&&(a.dataset.init="true")}var s=this._config.onRenderItem(t,n,this);const l=document.createElement("li");l.setAttribute("role","presentation"),l.classList.add("dropdown-item__li"),t.group_id&&l.setAttribute("data-group-id",""+t.group_id);const o=document.createElement("a"),r=document.createElement("span");t.data.styleColor&&(r.style.color=t.data.styleColor,r.style.borderColor=t.data.styleColor,r.style.borderWidth="1px",r.style.borderStyle="solid"),l.append(o),o.setAttribute("id",this._dropElement.getAttribute("id")+"-"+e),o.classList.add("dropdown-item"),t.disabled&&o.classList.add("disabled"),o.setAttribute(VALUE_ATTRIBUTE,i),o.setAttribute("data-label",n),o.setAttribute("href","#"),r.innerHTML=s,o.appendChild(r),this._dropElement.appendChild(l),o.addEventListener("mouseenter",e=>{this._keyboardNavigation||(this.removeSelection(),l.querySelector("a").classList.add(...this._activeClasses()))}),o.addEventListener("mousedown",e=>{e.preventDefault()}),o.addEventListener("click",e=>{e.preventDefault(),this._add(n,i,t.data),this._config.onSelectItem(t,this)})}}initialOptions(){return this._selectElement.querySelectorAll("option[data-init]")}reset(){this.removeAll(),this._fireEvents=!1;var t=this.initialOptions();for(let e=0;e<t.length;e++){var s=t[e];this.addItem(s.textContent,s.value,s.dataset)}this._adjustWidth(),this._fireEvents=!0}resetSearchInput(e=!1){this._searchInput.value="",this._adjustWidth(),e||(this.hideSuggestions(),this._searchInput===document.activeElement&&this._searchInput.dispatchEvent(new Event("input"))),this._config.max&&this.getSelectedValues().length>=this._config.max?this._searchInput.style.visibility="hidden":"hidden"==this._searchInput.style.visibility&&(this._searchInput.style.visibility="visible"),this.isSingle()&&!e&&document.activeElement.blur()}getSelectedValues(){var e=this._selectElement.querySelectorAll("option[selected]");return Array.from(e).map(e=>e.value)}getAvailableValues(){var e=this._selectElement.querySelectorAll("option");return Array.from(e).map(e=>e.value)}showOrSearch(e=!0){!e||this._shouldShow()?this._config.liveServer?this._searchFunc():this._showSuggestions():this.hideSuggestions(!1)}hideSuggestions(e=!0){this._dropElement.classList.remove(SHOW_CLASS),this._searchInput.ariaExpanded="false",this.removeSelection(),e&&this._holderElement.classList.remove(INVALID_CLASS)}toggleSuggestions(e=!0,t=!0){this._dropElement.classList.contains(SHOW_CLASS)?this.hideSuggestions(t):this.showOrSearch(e)}_shouldShow(){return!this.isDisabled()&&(!(0<this._config.maximumItems&&this.getSelectedValues().length>=this._config.maximumItems)&&this._searchInput.value.length>=this._config.suggestionsThreshold)}_showSuggestions(){if("hidden"!=this._searchInput.style.visibility){var o=removeDiacritics(this._searchInput.value).toLowerCase();const _=this.getSelectedValues();var r=this._dropElement.querySelectorAll("li");let s=0,i=null,n=!1,l={};for(let t=0;t<r.length;t++){var a=r[t];let e=a.firstElementChild;if(e instanceof HTMLSpanElement)a.dataset.id&&(l[a.dataset.id]=!1),hideItem(a);else if(e.classList.remove(...this._activeClasses()),this._config.allowSame||-1==_.indexOf(e.getAttribute(VALUE_ATTRIBUTE))){const m=removeDiacritics(e.textContent).toLowerCase();var h=0<o.length?m.indexOf(o):-1,c=0<=h||0===o.length&&0===this._config.suggestionsThreshold,d=this._config.showAllSuggestions||0===o.length,u=c||0===o.length;if(d||c?(s++,showItem(a),a.dataset.groupId&&(l[a.dataset.groupId]=!0),!i&&u&&(i=a),0<this._config.maximumItems&&s>this._config.maximumItems&&hideItem(a)):hideItem(a),this._config.highlightTyped&&c){const p=e.textContent;h=p.substring(0,h)+`<mark>${p.substring(h,h+o.length)}</mark>`+p.substring(h+o.length,p.length);e.innerHTML=h}this._isItemEnabled(a)&&(n=!0)}else hideItem(a)}if(this._config.allowNew||0===o.length&&!n||this._holderElement.classList.add(INVALID_CLASS),this._config.allowNew&&this._config.regex&&this.isInvalid()&&this._holderElement.classList.remove(INVALID_CLASS),Array.from(r).filter(e=>e.dataset.id).forEach(e=>{!0===l[e.dataset.id]&&showItem(e)}),n&&(this._holderElement.classList.remove(INVALID_CLASS),i&&this._config.autoselectFirst&&(this.removeSelection(),this._moveSelection(NEXT,i))),0===s)if(this._config.notFoundMessage){const e=this._dropElement.querySelector("."+CLASS_PREFIX+"not-found");e.style.display="block",this._showDropdown()}else this.hideSuggestions(!1);else this._showDropdown()}}_showDropdown(){this._dropElement.classList.add(SHOW_CLASS),this._searchInput.ariaExpanded="true",this._positionMenu()}_positionMenu(){var e=window.getComputedStyle(this._searchInput),t=this._searchInput.getBoundingClientRect(),e="rtl"===e.direction;let s=null,i=null;this._config.fixed?(s=this._config.fullWidth?this._holderElement.getBoundingClientRect().x:t.x,i=t.y+t.height):s=this._config.fullWidth?0:this._searchInput.offsetLeft,e&&!this._config.fullWidth&&(s-=this._dropElement.offsetWidth-t.width),this._config.fullWidth||(n=Math.min(window.innerWidth,document.body.offsetWidth),(n=e?t.x+t.width-this._dropElement.offsetWidth-1:n-1-(t.x+this._dropElement.offsetWidth))<0&&(s=e?s-n:s+n)),this._dropElement.style.transform="unset",this._config.fullWidth&&(this._dropElement.style.width=this._holderElement.offsetWidth+"px"),null!==s&&(this._dropElement.style.left=s+"px"),null!==i&&(this._dropElement.style.top=i+"px");var e=this._dropElement.getBoundingClientRect(),n=Math.min(window.innerHeight,document.body.offsetHeight);n-1-(e.y+e.height)<0&&t.y>n/2&&(this._dropElement.style.transform="translateY(calc(-100% - "+this._searchInput.offsetHeight+"px))")}_getBootstrapVersion(){let e=5;return window.jQuery&&null!=$.fn.tooltip&&null!=$.fn.tooltip.Constructor&&(e=parseInt($.fn.tooltip.Constructor.VERSION.charAt(0))),e}_isSelected(t){const e=Array.from(this._selectElement.querySelectorAll("option")).find(e=>e.textContent==t);return!(!e||!e.getAttribute("selected"))}_validateRegex(e){const t=new RegExp(this._config.regex.trim());return t.test(e)}getSelection(){return this._dropElement.querySelector("a."+ACTIVE_CLASS)}removeSelection(){const e=this.getSelection();e&&e.classList.remove(...this._activeClasses())}_activeClasses(){return[...this._config.activeClasses,ACTIVE_CLASS]}getActiveSelection(){return this.getSelection()}removeActiveSelection(){return this.removeSelection()}removeAll(){let e=this.getSelectedValues();e.forEach(e=>{this.removeItem(e,!0)}),this._adjustWidth()}removeLastItem(t=!1){var s=this._containerElement.querySelectorAll("span.badge:not(.disabled)");if(s.length){let e=s[s.length-1];this.removeItem(e.getAttribute(VALUE_ATTRIBUTE),t)}}enable(){this._selectElement.setAttribute("disabled",""),this.resetState()}disable(){this._selectElement.removeAttribute("disabled"),this.resetState()}isDisabled(){return this._selectElement.hasAttribute("disabled")||this._selectElement.disabled||this._selectElement.hasAttribute("readonly")}isDropdownVisible(){return this._dropElement.classList.contains(SHOW_CLASS)}isInvalid(){return this._holderElement.classList.contains(INVALID_CLASS)}isSingle(){return!this._selectElement.hasAttribute("multiple")}canAdd(e,t={}){return!!e&&(!this.isDisabled()&&(!(!this.isSingle()&&!this._config.allowSame&&this._isSelected(e))&&(!(this._config.max&&this.getSelectedValues().length>=this._config.max)&&((!this._config.regex||!t.new||this._validateRegex(e))&&(!this._config.onCanAdd||!1!==this._config.onCanAdd(e,t,this))||(this._holderElement.classList.add(INVALID_CLASS),!1)))))}addItem(t,e=null,s={}){e=e||t,this.isSingle()&&this.getSelectedValues().length&&this.removeLastItem(!0);var i=CSS.escape(e);let n=this._selectElement.querySelectorAll('option[value="'+i+'"]'),l=null;if(this._config.allowSame?n.forEach(e=>{e.textContent!==t||e.selected||(l=e)}):l=n[0]||null,!l){l=document.createElement("option"),l.value=e,l.textContent=t;for(const[o,e]of Object.entries(s))l.dataset[o]=e;this._selectElement.appendChild(l)}l&&(s=Object.assign({},s,l.dataset)),l.setAttribute("selected","selected"),l.selected=!0;i=this._selectElement.innerHTML;return this._selectElement.innerHTML="",this._selectElement.innerHTML=i,this._createBadge(t,e,s),this._fireEvents&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0})),l}_createBadge(e,t=null,s={}){var i=this._getBootstrapVersion(),n=this._config.allowClear&&!s.disabled;let l=e,o=document.createElement("span"),r=["badge"],a=this._config.badgeStyle;if(s.badgeStyle&&(a=s.badgeStyle),s.badgeClass&&r.push(...s.badgeClass.split(" ")),this._config.baseClass?r.push(...this._config.baseClass.split(" ")):r=5===i?[...r,"bg-"+a,"mw-100","overflow-x-hidden"]:[...r,"badge-"+a],s.disabled&&r.push("disabled","opacity-50"),o.style.margin="2px 6px 2px 0px",o.style.marginBlock="2px",o.style.marginInline="0px 6px",o.classList.add(...r),s?.styleColor?(o.style.color=s?.styleColor,o.style.borderColor=s?.styleColor):(o.style.color=selectedColor,o.style.borderColor=selectedColor),o.style.borderStyle="solid",o.style.borderWidth="1px",o.setAttribute(VALUE_ATTRIBUTE,t),n){s=r.includes("text-dark")?"btn-close":"btn-close-white";let e,t;t=this._config.clearEnd?(e=5===i?"ms-2":"ml-2",5===i?"float-end":"float:right;"):(e=5===i?"me-2":"mr-2",5===i?"float-start":"float:left;");s=5===i?'<button type="button" class="'+e+" "+t+" btn-close "+s+'" aria-label="'+this._config.clearLabel+'"></button>':'<button type="button"'+t+'text-shadow:none;color:currentColor;" class=" close" aria-label="'+this._config.clearLabel+'"><span aria-hidden="true" class="ml-1"><i class="icon__16x16 icon-close__16"></i></span></button>';l=s+l}o.innerHTML=l,this._containerElement.insertBefore(o,this._searchInput),n&&o.querySelector("button").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.isDisabled()||(this.removeItem(t),document.activeElement.blur(),this._adjustWidth())})}removeItem(t,s=!1){var i=CSS.escape(t);let n=this._containerElement.querySelector("span["+VALUE_ATTRIBUTE+'="'+i+'"]');if(n){n.remove();let e=this._selectElement.querySelector('option[value="'+i+'"][selected]');e&&(e.removeAttribute("selected"),e.selected=!1,this._fireEvents&&!s&&this._selectElement.dispatchEvent(new Event("change",{bubbles:!0}))),"hidden"==this._searchInput.style.visibility&&this._config.max&&this.getSelectedValues().length<this._config.max&&(this._searchInput.style.visibility="visible"),s||this._config.onClearItem(t,this)}}}export default BootstrapInputsTags;